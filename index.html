<!--

		Licensed to the Apache Software Foundation (ASF) under one
		or more contributor license agreements.  See the NOTICE file
		distributed with this work for additional information
		regarding copyright ownership.  The ASF licenses this file
		to you under the Apache License, Version 2.0 (the
		"License"); you may not use this file except in compliance
		with the License.  You may obtain a copy of the License at

		http://www.apache.org/licenses/LICENSE-2.0

		Unless required by applicable law or agreed to in writing,
		software distributed under the License is distributed on an
		"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
		 KIND, either express or implied.  See the License for the
		specific language governing permissions and limitations
		under the License.

-->
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<!-- <link rel="stylesheet" href="http://code.jquery.com/mobile/1.1.0/jquery.mobile-1.1.0.min.css">
<script src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
<script src="http://code.jquery.com/mobile/1.1.0/jquery.mobile-1.1.0.min.js"></script>
 <link rel="stylesheet" href="jquery.mobile-1.1.0.custom.css?" />
 -->    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
				<meta name="format-detection" content="telephone=no" />
	 <!--     <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, target-densitydpi=device-dpi" /> -->
				<link rel="stylesheet" type="text/css" href="css/index.css" />
<link rel="stylesheet" href="themes/PhollarPay.min.css" />
<link rel="stylesheet" href="themes/jquery.mobile.icons.min.css" />
<link rel="stylesheet" href="http://code.jquery.com/mobile/1.4.2/jquery.mobile.structure-1.4.2.min.css" />
<script src="http://code.jquery.com/jquery-1.10.2.min.js"></script>
<script src="http://code.jquery.com/mobile/1.4.2/jquery.mobile-1.4.2.min.js"></script>


<link href="css/bootstrap.min.css" rel="stylesheet"> 


<link href="dashboard.css" rel="stylesheet">			 

<script>




if(localStorage.getItem("existing")!=null)
{
	 window.open("#MenuPage","_self");
}
else
{
		window.open("#Welcome","_self");
}

</script>



</head>


<body>





<!--         Welcome Page               -->



<div id="Welcome" data-url="Welcome" data-role="page">
<div data-role="header" data-swatch="a">
<center><img src="Logo.png" height="40px" width="120px"></center>
</div>

<div data-role="content" data-swatch="a">

<ul data-role="listview" data-inset="true">
<li data-icon="false" onclick="IsMerch()"><a><center>Register</center></a></li>
<li data-icon="false"><a href="#SignInPage"><center>Sign In</center></a></li>
</ul>

</div>

<div data-role="footer" data-theme="a" data-position="fixed">
<h1>ⒸGoCent</h1>
</div>
</div>

<!-- <div id="dialog-confirm">
	<p><span class="ui-icon ui-icon-alert" style="float:left; margin:0 7px 20px 0;"></span>Do you want to register as a Merchant?</p>
</div>
 
 -->
 <script type="text/javascript">
 function IsMerch()
 {
		var answer = confirm("Register as a merchant?")
		if (answer){
					 window.open("#MerReg","_self");
		}
		else{
						 window.open("#CusReg","_self");
		}



 }



 </script>





<!--         Customer Registration               -->



<div id="CusReg" data-url="CusReg" data-role="page">
<div data-role="header" data-swatch="a">
<center><img src="Logo.png" height="40px" width="120px"></center>
</div>


<form id="Registration">

<div data-role="content" data-swatch="a">
<center><h3>Customer Registration</h3></center>

<div data-role="fieldcontain">
<label for="inp_tw31">First Name:</label>

<input type="text" id="fName"> 
</div>
<div data-role="fieldcontain">
<label for="inp_tw23">Last Name:</label>
<input type="text" id="lName" data-mini="true">
</div>
<div data-role="fieldcontain">
<label for="inp_tw23">Email:</label>
<input type="text" id="email">
</div>
<div data-role="fieldcontain">
<label for="inp_tw30">Password:</label>
<input type="password" id="password" data-mini="true"/>
</div>
<div>
<center><input type="button" id="Cregbutton" value="Register!" data-inline="true"></center>
</div>
</div>
</form>

<div data-role="footer" data-theme="a" data-position="fixed" data-tap-toggle="false">
<h1>ⒸGoCent</h1>

</div>
</div>







		<script>

		$("#Cregbutton").click(function() {

			localStorage["ISMERCHANT?"] = "false";
										

		$.ajax({
			dataType: "json",
			type: "POST",
			crossdomain: true,
			url: "http://goskash.appspot.com/Registration",
			data: {'fName': fName.value,'lName': lName.value,'email': email.value,'password': password.value,'isMerchant': localStorage.getItem("ISMERCHANT?")},
			success: function(response){
								if(response.valid=="true"){
										alert("Great to have you on board!");
										localStorage["existing"] = email.value;
										window.open("#MenuPage","_self");
								}
								else if(response.valid=="false"){
										alert(response.error);
								}
						}
		});

		});


		</script>




<!--         Merchant Registration               -->



<div id="MerReg" data-url="MerReg" data-role="page">
<div data-role="header" data-swatch="a">
<center><img src="Logo.png" height="40px" width="120px"></center>
</div>


<form id="RegistrationMerchant">

<div data-role="content" data-swatch="a">
<center><h3>Merchant Registration</h3></center>



<div data-role="fieldcontain">
<label for="inp_tw31">First Name:</label>

<input type="text" id="fName2" id="inp_tw31" /> 
</div>
<div data-role="fieldcontain">
<label for="inp_tw23">Last Name:</label>
<input type="text" id="lName2" id="inp_tw23" data-mini="true"/>
</div>

<div data-role="fieldcontain">
<label for="inp_tw31">Merchant Name:</label>
<input type="text" id="merName" id="inp_tw36" /> 
</div>

<div data-role="fieldcontain">
<label for="inp_tw23">Email:</label>
<input type="text" id="email2" id="inp_tw23">
</div>

<div data-role="fieldcontain">
<label for="inp_tw30">Password:</label>
<input type="password" id="password2" id="inp_tw30"  data-mini="true"/>
</div>

<!-- <div data-role="fieldcontain">
<label for="inp_tw32">Currency Code:</label>
<input type="text" id="currency2" id="inp_tw32" />
</div> 
 -->

<div data-role="fieldcontain">
<label for="inp_tw32">Stripe Key:</label>
<input type="text" id="stripeKey" id="inp_tw32" />
</div> 


<div>
<center><input type="button" id="Mregbutton" value="Register!" data-inline="true"></center>
</div>
</div>
</form>

<div data-role="footer" data-theme="a" data-position="fixed" data-tap-toggle="false">
<h1>ⒸGoCent</h1>

</div>
</div>






		<script>

		$("#Mregbutton").click(function() {

			localStorage["ISMERCHANT?"]="true";

		$.ajax({
			dataType: "json",
			type: "POST",
			url: "http://goskash.appspot.com/Registration",
			crossdomain: true,
			data: {'fName': fName2.value,'lName': lName2.value,'email': email2.value,'password': password2.value,'merchantName': merName.value,'stripeKey': stripeKey.value,'isMerchant': localStorage.getItem("ISMERCHANT?")},
			success: function(response){
								if(response.valid=="true"){
										alert("Great to have you on board!");
										localStorage["existing"] = email2.value;
										localStorage["ISMERCHANT?"]=response.isMerchant;
										window.open("#MenuPage","_self");
								}
								else if(response.valid=="false"){
										alert(response.error);
								}
						}
		});

		});


		</script>







<!--         Sign In               -->

<div id="SignInPage" data-url="SignInPage" data-role="page">
<div data-role="header" data-swatch="a">
<center><img src="Logo.png" height="40px" width="120px"></center>
</div>

<div data-role="content" data-swatch="a">
<form id="Login">

<div data-role="fieldcontain">
<label for="inp_tw23">Email:</label>
<input type="text" id="email1" data-mini="true">
</div>
<div data-role="fieldcontain">
<label for="inp_tw23">Password:</label>
<input type="password" id="password1" data-mini="true">
</div>
<div>

<center><input type="button" id="loginbutton" value="Sign In!" data-inline="true"></center>
</div>
</form>

</div>


<div data-role="footer" data-swatch="a" data-position="fixed" data-tap-toggle="false">
<h1>ⒸGoCent</h1>
</div>
</div>

		<script>



		$("#loginbutton").click(function() {

		$.ajax({	
			dataType: "json",
			type: "POST",
			crossdomain: true,
			url: "http://goskash.appspot.com/Login",
			data: {'email': Login.email1.value,'password': Login.password1.value},
				success: function(response){


						if(response.valid=="true"){

								var d=new Date();

								var ts=d.getTime();
								// var token = {email : response.id, timestamp : ts};

								// var str = JSON.stringify(token);

								localStorage["id"] = response.id;
								localStorage["ts"] = ts;								
								localStorage["existing"] = email1.value;
								localStorage["ISMERCHANT?"] = response.isMerchant;
						 // document.write(ciphertext);

								window.open("#MenuPage","_self");
						}
						else if(response.valid=="false"){
								alert(response.error);
						}
				},
								error: function(XMLHttpRequest, textStatus, errorThrown) { 
                    alert("Status: " + textStatus); alert("Error: " + errorThrown); 
                }

		});
		});


		</script>





<!--         Dashboard Page               -->



<div id="DashboardPage" data-url="DashboardPage" data-role="page">
<div data-role="header" data-swatch="a">
<center><img src="Logo.png" height="40px" width="120px"></center>
</div>

<div data-role="content" data-swatch="a">
		
		<ul data-role="listview" data-inset="true">
<li data-icon="false"><a href="#History"><center>Transaction History</center></a></li>
<li data-icon="false"><a href="#Inventory"><center>Inventory List</center></a></li>
<li data-icon="false"><a href="#"><center>Merchant Profile</center></a></li>


</div>

<div data-role="footer" data-theme="a" data-position="fixed" data-tap-toggle="false">
<h1>ⒸGoCent</h1>
</div>
</div>


 




<!--             Menu Page              -->



<div id="MenuPage" data-url="MenuPage" data-role="page">
<div data-role="header" data-swatch="a">
<center><img src="Logo.png" height="40px" width="120px"></center></div>

<div data-role="content" data-swatch="a">

<ul data-role="listview" data-inset="true">
<li data-icon="false"><a href="#" id="scan"><center>Make Payment</center></a></li>
<li data-icon="false"><a href="#GetPayment"><center>Get Payment</center></a></li>
<li data-icon="false"><a href="" onclick="checkIfMerch()"><center>Wallet</center></a></li>
</ul>
</div>

<script type="text/javascript">
	function checkIfMerch()
	{
		if(localStorage.getItem("ISMERCHANT?")=="true")
		{
			window.open("#MerchWalletPage","_self");
		}
		else
		{
			window.open("#CustWalletPage","_self");
		}
	}
</script>


<div data-role="footer" data-swatch="a" data-position="fixed" data-tap-toggle="false">
<h1>ⒸGoCent</h1>
</div>
</div>



<!-- 					Get Payment						-->


<div id="GetPayment" data-url="GetPayment" data-role="page">
<div data-role="header" data-swatch="a">
<center><img src="Logo.png" height="40px" width="120px"></center>
</div>

 <div id="formContent" data-role="content" data-swatch="a">        

<Form name="GetPay">
<div data-role="fieldcontain">
<label for="inp_tw23">Amount:</label>
<input type="text" id="amount" data-mini="true">
</div>
<div data-role="fieldcontain">
<label for="inp_tw23">Currency Code:</label>
<input type="text" id="currency" data-mini="true">
</div>
<div>

<center><input type="button" id="getpay" value="QR Code me" data-inline="true"></center>
</div>


</Form>

</div>

<div data-role="footer" data-swatch="a" data-position="fixed">
<h1>ⒸGoCent</h1>
</div>
</div>




<script>



$("#getpay").click(function() {

		$.ajax({	
			dataType: "json",
			type: "GET",
			crossdomain: true,
			url: "http://goskash.appspot.com/phollar/createTransaction",
			data: {'merchantId': localStorage.getItem("id"),'amount': amount.value,'currencyCode':currency.value,'peer': 'true'},
			beforeSend: function (request) {
             request.setRequestHeader("token", localStorage.getItem("id"));
            },
				success: function(response){


						if(response.valid=="true"){

						 
						// window.open(JSON.stringify(response.url),"_self");

						$('#formContent').html('<img src='+response.url+'>');

						}
						else if(response.valid=="false"){
								alert(response.error);
						}
				},
								error: function(XMLHttpRequest, textStatus, errorThrown) { 
                    alert("Status: " + textStatus); alert("Error: " + errorThrown); 
                }

		});
		});




</script>






<!--          Customer Wallet Page              -->



<div id="CustWalletPage" data-url="CustWalletPage" data-role="page">
<div data-role="header" data-swatch="a">
<center><img src="Logo.png" height="40px" width="120px"></center></div>

<div data-role="content" data-swatch="a">

<ul data-role="listview" data-inset="true">
<li data-icon="false"><a href="#"><center>View Cards</center></a></li>
<li data-icon="false"><a href="#AddCard"><center>Add Card</center></a></li>
</ul>
</div>

<div data-role="footer" data-swatch="a" data-position="fixed" data-tap-toggle="false">
<h1>ⒸGoCent</h1>
</div>
</div>











<!--          Merchant Wallet Page              -->



<div id="MerchWalletPage" data-url="MerchWalletPage" data-role="page">
<div data-role="header" data-swatch="a">
<center><img src="Logo.png" height="40px" width="120px"></center></div>

<div data-role="content" data-swatch="a">

<ul data-role="listview" data-inset="true">
<li data-icon="false"><a href="#DashboardPage"><center>Dashboard</center></a></li>
<li data-icon="false"><a href="#"><center>View Cards</center></a></li>
<li data-icon="false"><a href="#AddCard"><center>Add Card</center></a></li>
</ul>
</div>

<div data-role="footer" data-swatch="a"  data-position="fixed" data-tap-toggle="false">
<h1>ⒸGoCent</h1>
</div>
</div>










<!--           Add Card Page        -->



<div id="AddCard" data-url="AddCard" data-role="page">

<div data-role="header" data-swatch="a">
<center><img src="Logo.png" height="40px" width="120px"></center>

</div>


<div data-role="content" data-swatch="a">
			<center> <img src="img/card.png" width="50px" height="50px"><center>        

<h3>Card Details</h3>


<form id="newcard">

<div data-role="fieldcontain">
<label for="inp_tw31">Name on card</label>
<input type="text" id="cardname">
</div>
<div data-role="fieldcontain">
<label for="inp_tw23">Card No</label>
<input type="text" id="cno" value="xxxxxxxxxxxxxxxx" data-mini="true">
</div>
<div data-role="fieldcontain">
<label for="sel_tw28">Validity(MM/YY)</label>
<input type="text" id="val" data-mini="true">
</div>
<div data-role="fieldcontain">
<label for="inp_tw32">CVV</label>
<input type="text" id="cvv">
</div>
<div>
<center><input type="button" value="save" id="addcardbutton" data-inline="true"></center>
</div>
</form>

</div>

<div data-role="footer" data-swatch="a" data-position="fixed" data-tap-toggle="false">
<h1>ⒸGoCent</h1>
</dsiv>
</div>



		<script>


	$("#addcardbutton").click(function() {


		var card={};

		card.nameOnCard=cardname.value;

		card.cardNo=cno.value;

		card.exp=val.value;

		card.cvv=cvv.value;

		var allcardsString = localStorage.getItem("allcards");
		var allcards=[];

		if(allcardsString!=null) {
			
			allcards = JSON.parse(allcardsString);
		}

		allcards[allcards.length] = card;

		localStorage["allcards"] = JSON.stringify(allcards);

		window.open("#MenuPage","_self");

		});

		
		</script>










<!--                Select card Page                -->

<div id="SelectCard" data-url="SelectCard" data-role="page">
<div data-role="header" data-swatch="a">
<center><img src="Logo.png" height="40px" width="120px"></center>
</div>

<div data-role="content" data-swatch="a">
<div class="cardlist">

<h1>Select Card</h1>
 <div data-role="fieldcontain">
<center><input type="button" id="0" value="card0" class="card" data-inline="true"></center>
</div>
<!--
<div data-role="fieldcontain">
<center><input type="button" id="1" value="card1" class="card" data-inline="true"></center>
</div> -->
</div>
</div>

<div data-role="footer" data-swatch="a" data-position="fixed" data-tap-toggle="false">
<h1>ⒸGoCent</h1>
</div>

<script>

$('.card').click(function() {


	var selectedCard = $(this).attr('id');
	var cards=[];
	cards=JSON.parse(localStorage.getItem("allcards"));

		//alert(JSON.stringify(cards[0]));

		$.ajax({	
			dataType: "json",
			type: "POST",
			crossdomain: true,
			beforeSend: function (request) {
       request.setRequestHeader("token", localStorage.getItem("id"));
       },
			url: "http://goskash.appspot.com/phollar/PayAPI",
			data: {'userId': localStorage.getItem("id"),'productId': localStorage.getItem("productId"),'cardNo': cards[parseInt(selectedCard)].cardNo, 'cardExp':cards[parseInt(selectedCard)].exp, 'cvv': cards[parseInt(selectedCard)].cvv},
				success: function(response){


						if(response.valid=="true"){

							alert("Succesful Payment!");

								window.open("#MenuPage","_self");
						}
						else if(response.valid=="false"){
								alert("Payment Failed!");
						}
				},
								error: function(XMLHttpRequest, textStatus, errorThrown) { 
                    alert("Status: " + textStatus); alert("Error: " + errorThrown); 
                }

		});

	});




</script>
















				
				 <script type="text/javascript" src="cordova.js"></script>
				 <script type="text/javascript" src="barcodescanner.js"></script>
				 <script type="text/javascript" src="childbrowser.js"></script>
				 <script type="text/javascript" src="js/index.js"></script>
				 <script type="text/javascript">
						app.initialize();
				</script>

</body>
</html>
